<!DOCTYPE html>
<html>
  <head>
    <title>OpenVPN Authentication</title>
    <script src="https://accounts.google.com/gsi/client" defer></script>
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='favicon.ico') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <style>
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      .tab-button {
        padding: 10px 20px;
        border: none;
        background: #f0f0f0;
        cursor: pointer;
        border-radius: 4px;
        margin-right: 8px;
      }
      .tab-button.active {
        background: #4a90e2;
        color: white;
      }
      .instruction-card {
        background: white;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 16px;
        margin: 16px 0;
      }
      .download-link {
        display: inline-flex;
        align-items: center;
        color: #4a90e2;
        text-decoration: none;
        padding: 8px 16px;
        border: 1px solid #4a90e2;
        border-radius: 4px;
        margin-top: 8px;
      }
      .download-link:hover {
        background: #4a90e2;
        color: white;
      }
      pre {
        background: #f5f5f5;
        padding: 12px;
        border-radius: 4px;
        overflow-x: auto;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="status">Server Status: Active âœ“</div>
      <h1>OpenVPN Authentication Portal</h1>
      <p>To download your VPN configuration:</p>
      <ol>
        <li>Sign in with your organization account</li>
        <li>Download your personalized OpenVPN configuration file</li>
        <li>Import the configuration into your OpenVPN client</li>
      </ol>

      <div id="signInDiv"></div>

      <!-- VPN Setup Instructions -->
      <div id="setupInstructions" style="display: none">
        <h2>VPN Setup Instructions</h2>

        <div class="tabs">
          <button class="tab-button active" onclick="showTab('windows')">
            Windows
          </button>
          <button class="tab-button" onclick="showTab('mac')">macOS</button>
          <button class="tab-button" onclick="showTab('linux')">Linux</button>
        </div>

        <div id="windows" class="tab-content active">
          <div class="instruction-card">
            <h3>Step 1: Download OpenVPN Client</h3>
            <a
              href="https://openvpn.net/downloads/openvpn-connect-v3-windows.msi"
              class="download-link"
            >
              Download OpenVPN Connect for Windows
            </a>
          </div>

          <div class="instruction-card">
            <h3>Step 2: Install OpenVPN Connect</h3>
            <ol>
              <li>Double-click the downloaded MSI file</li>
              <li>Follow the installation wizard</li>
              <li>Accept the default settings when prompted</li>
            </ol>
          </div>

          <div class="instruction-card">
            <h3>Step 3: Import Configuration</h3>
            <ol>
              <li>
                Download your personal client.ovpn file using the button below
              </li>
              <li>Double-click the downloaded .ovpn file</li>
              <li>
                OpenVPN Connect will automatically import the configuration
              </li>
              <li>Click "Connect" to establish the VPN connection</li>
            </ol>
          </div>
        </div>

        <div id="mac" class="tab-content">
          <div class="instruction-card">
            <h3>Step 1: Download OpenVPN Client</h3>
            <a
              href="https://openvpn.net/downloads/openvpn-connect-v3-macos.dmg"
              class="download-link"
            >
              Download OpenVPN Connect for macOS
            </a>
          </div>

          <div class="instruction-card">
            <h3>Step 2: Install OpenVPN Connect</h3>
            <ol>
              <li>Open the downloaded .dmg file</li>
              <li>Drag OpenVPN Connect to the Applications folder</li>
              <li>Launch OpenVPN Connect from Applications</li>
              <li>Allow system extensions if prompted</li>
            </ol>
          </div>

          <div class="instruction-card">
            <h3>Step 3: Import Configuration</h3>
            <ol>
              <li>
                Download your personal client.ovpn file using the button below
              </li>
              <li>Open OpenVPN Connect</li>
              <li>
                Drag and drop the .ovpn file into the OpenVPN Connect window
              </li>
              <li>Click "Add" to import the profile</li>
              <li>Click "Connect" to establish the VPN connection</li>
            </ol>
          </div>
        </div>

        <div id="linux" class="tab-content">
          <div class="instruction-card">
            <h3>Debian/Ubuntu Installation</h3>
            <p>Open terminal and run the following commands:</p>
            <pre>
sudo apt update
sudo apt install openvpn</pre
            >
          </div>

          <div class="instruction-card">
            <h3>Fedora/RHEL Installation</h3>
            <p>Open terminal and run the following commands:</p>
            <pre>sudo dnf install openvpn</pre>
          </div>

          <div class="instruction-card">
            <h3>Import Configuration</h3>
            <ol>
              <li>
                Download your personal client.ovpn file using the button below
              </li>
              <li>Move the configuration file to the OpenVPN directory:</li>
              <pre>sudo mv ~/Downloads/client.ovpn /etc/openvpn/client/</pre>
              <li>Start the VPN connection:</li>
              <pre>sudo openvpn --config /etc/openvpn/client/client.ovpn</pre>
              <li>Or enable it as a system service:</li>
              <pre>sudo systemctl enable --now openvpn-client@client</pre>
            </ol>
          </div>
        </div>
      </div>

      <button id="downloadBtn" class="download-btn hidden">
        Download OpenVPN Config
      </button>
    </div>

    <script>
      const CLIENT_ID = "{{ client_id }}";

      function showTab(tabName) {
        // Hide all tab contents
        document.querySelectorAll(".tab-content").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Deactivate all buttons
        document.querySelectorAll(".tab-button").forEach((button) => {
          button.classList.remove("active");
        });

        // Show selected tab content and activate button
        document.getElementById(tabName).classList.add("active");
        document
          .querySelector(`button[onclick="showTab('${tabName}')"]`)
          .classList.add("active");
      }
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  </body>
</html>
